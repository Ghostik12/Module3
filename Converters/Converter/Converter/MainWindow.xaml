<Window x:Class="Converter.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:vm="clr-namespace:Converter.ViewModels"
        Title="Конвертер" Height="650" Width="1000" Background="#13527f">

    <Grid Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- === ВЫБОР ФОРМАТОВ === -->
        <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,15" VerticalAlignment="Center">
            <TextBlock Text="Из:" Width="40" VerticalAlignment="Center" FontWeight="SemiBold" Foreground="White"/>
            <ComboBox ItemsSource="{Binding SourceFormats}" 
                      SelectedItem="{Binding SourceFormat}" 
                      Width="130" Margin="40,0" FontSize="14"/>

            <TextBlock Text="→" FontWeight="Bold" FontSize="18" Margin="10,0" VerticalAlignment="Center" Foreground="White"/>

            <TextBlock Text="В:" Width="40" VerticalAlignment="Center" FontWeight="SemiBold" Foreground="White"/>
            <ComboBox ItemsSource="{Binding TargetFormats}" 
                      SelectedItem="{Binding TargetFormat}" 
                      Width="130" Margin="5,0" FontSize="14"/>
        </StackPanel>

        <!-- === ИСХОДНЫЙ ФАЙЛ === -->
        <StackPanel Grid.Row="1" Orientation="Horizontal" Margin="0,0,0,10">
            <TextBlock Text="Файл:" Width="80" VerticalAlignment="Center" FontWeight="SemiBold" Foreground="White"/>
            <TextBox Text="{Binding SourcePath}" 
                     Width="650" 
                     IsReadOnly="True" 
                     Margin="0,0,10,0"
                     Background="White"
                     Padding="5"/>
            <Button Content="Обзор..." 
                    Command="{Binding BrowseSourceCommand}" 
                    Width="100" 
                    Height="32"
                    Background="#0078D7"
                    Foreground="White"
                    FontWeight="SemiBold"
                    Style="{StaticResource RoundedButton}"/>
        </StackPanel>

        <!-- === ЦЕЛЕВОЙ ФАЙЛ === -->
        <StackPanel Grid.Row="2" Orientation="Horizontal" Margin="0,0,0,15">
            <TextBlock Text="Сохранить:" Width="80" VerticalAlignment="Center" FontWeight="SemiBold" Foreground="White"/>
            <TextBox Text="{Binding TargetPath}" 
                     Width="650" 
                     IsReadOnly="True" 
                     Margin="0,0,10,0"
                     Background="White"
                     Padding="5"/>
            <Button Content="Обзор..." 
                    Command="{Binding BrowseTargetCommand}" 
                    Width="100" 
                    Height="32"
                    Background="#28A745"
                    Foreground="White"
                    FontWeight="SemiBold"
                    Style="{StaticResource RoundedButton}"/>
        </StackPanel>

        <!-- === СТОЛБЦЫ + ПРЕВЬЮ === -->
        <Grid Grid.Row="3" IsEnabled="{Binding IsColumnSelectionEnabled}">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="240"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

            <!-- Столбцы -->
            <Border Grid.Column="0" Background="White" BorderBrush="#DDD" BorderThickness="1" CornerRadius="5" Padding="10">
                <StackPanel>
                    <TextBlock Text="Столбцы:" FontWeight="SemiBold" Margin="0,0,0,8"/>
                    <ScrollViewer Height="350" VerticalScrollBarVisibility="Auto">
                        <ListBox ItemsSource="{Binding Columns}">
                            <ListBox.ItemTemplate>
                                <DataTemplate>
                                    <CheckBox Content="{Binding Name}" 
                                              IsChecked="{Binding IsSelected}"
                                              Margin="2"/>
                                </DataTemplate>
                            </ListBox.ItemTemplate>
                        </ListBox>
                    </ScrollViewer>
                </StackPanel>
            </Border>

            <!-- Превью -->
            <Border Grid.Column="1" Background="White" BorderBrush="#DDD" BorderThickness="1" CornerRadius="5" Margin="15,0,0,0" Padding="10">
                <StackPanel>
                    <TextBlock Text="Превью (10 строк):" FontWeight="SemiBold" Margin="0,0,0,8"/>
                    <DataGrid ItemsSource="{Binding PreviewData}" 
                              AutoGenerateColumns="True" 
                              IsReadOnly="True" 
                              Height="350"
                              Background="White"
                              GridLinesVisibility="All"
                              HeadersVisibility="Column"/>
                </StackPanel>
            </Border>
        </Grid>

        <!-- === КНОПКА КОНВЕРТАЦИИ === -->
        <Button Grid.Row="4" 
                Content="Конвертировать" 
                Command="{Binding ConvertCommand}"
                Height="55"
                Width="200"
                FontSize="18" 
                FontWeight="Bold"
                Background="#0078D7" 
                Foreground="White" 
                Margin="0,20,0,0"
                IsEnabled="{Binding ConvertCommand.CanExecute}"
                Style="{StaticResource RoundedButton}"/>
        <Border Grid.Row="4" 
        Background="#FFEBEE" 
        BorderBrush="#D32F2F" 
        BorderThickness="1" 
        CornerRadius="6" 
        Padding="10,6" 
        HorizontalAlignment="Left" 
        Margin="672,21,0,0"
        MaxWidth="600"
        Visibility="{Binding ConversionStatus, Converter={StaticResource StringToVisibilityConverter}}" Width="186">

            <ScrollViewer MaxHeight="80" 
                  VerticalScrollBarVisibility="Auto"
                  HorizontalScrollBarVisibility="Disabled">
                <TextBlock Text="{Binding ConversionStatus}" 
                   Foreground="#D32F2F" 
                   FontWeight="SemiBold"
                   TextWrapping="Wrap"
                   FontSize="13"
                   LineHeight="18"/>
            </ScrollViewer>
        </Border>
    </Grid>
</Window>