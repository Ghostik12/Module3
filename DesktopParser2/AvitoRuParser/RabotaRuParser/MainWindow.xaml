<Window x:Class="AvitoRuParser.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:RabotaRuParser"
        Title="Парсер вакансий" WindowState="Maximized">
    <Window.Resources>
        <!-- Базовый стиль для кнопок -->
        <Style x:Key="BaseButtonStyle" TargetType="Button">
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="BorderBrush" Value="#FF707070"/>
            <Setter Property="Padding" Value="5"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="border" 
                            Background="{TemplateBinding Background}"
                            BorderBrush="{TemplateBinding BorderBrush}"
                            BorderThickness="{TemplateBinding BorderThickness}"
                            CornerRadius="8">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsEnabled" Value="False">
                                <Setter TargetName="border" Property="Opacity" Value="0.6"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Специфичные стили для цветных кнопок -->
        <Style x:Key="StartButtonStyle" BasedOn="{StaticResource BaseButtonStyle}" TargetType="Button">
            <Setter Property="Background" Value="#4CAF50"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="IsEnabled" Value="False"/>
        </Style>

        <Style x:Key="StopButtonStyle" BasedOn="{StaticResource BaseButtonStyle}" TargetType="Button">
            <Setter Property="Background" Value="#F44336"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="IsEnabled" Value="False"/>
        </Style>

        <Style x:Key="ExportButtonStyle" BasedOn="{StaticResource BaseButtonStyle}" TargetType="Button">
            <Setter Property="Background" Value="#2196F3"/>
            <Setter Property="Foreground" Value="White"/>
        </Style>

        <!-- Стиль для CheckBox с правильным выравниванием -->
        <Style TargetType="CheckBox">
            <Setter Property="VerticalContentAlignment" Value="Center"/>
            <Setter Property="HorizontalContentAlignment" Value="Center"/>
            <Setter Property="Margin" Value="5,0"/>
            <Setter Property="FontSize" Value="21"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="CheckBox">
                        <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                            <Border x:Name="border"
                                Width="20"
                                Height="20"
                                Background="White"
                                BorderBrush="#FF707070"
                                BorderThickness="1"
                                CornerRadius="3"
                                Margin="0,0,5,0">
                                <Path x:Name="checkMark"
                                  Data="M0,5 L5,10 L15,0"
                                  Stroke="White"
                                  StrokeThickness="2"
                                  Visibility="Collapsed"/>
                            </Border>
                            <ContentPresenter VerticalAlignment="Center"/>
                        </StackPanel>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsChecked" Value="True">
                                <Setter TargetName="border" Property="Background" Value="#FF0078D7"/>
                                <Setter TargetName="checkMark" Property="Visibility" Value="Visible"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </Window.Resources>
    <Grid Background="#F5F5F5">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <!-- Панель с кнопками -->
            <RowDefinition Height="Auto"/>
            <!-- Панель с фильтрами и пагинацией -->
            <RowDefinition Height="*"/>
            <!-- Таблица и лог -->
        </Grid.RowDefinitions>

        <!-- Панель инструментов (шапка) -->
        <Border Grid.Row="0" Background="#E0E0E0" Padding="10" BorderThickness="0,0,0,1" BorderBrush="#CCCCCC">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>

                <!-- Первая строка -->
                <StackPanel Grid.Row="0" Orientation="Horizontal">
                    <StackPanel Orientation="Horizontal" Margin="0,0,20,0">
                        <Label Content="Вакансия:" VerticalAlignment="Center" FontSize="21"/>
                        <TextBox x:Name="VacancyTitleTextBox" Width="150" Height="35" Margin="5,0" 
                        FontSize="21" VerticalContentAlignment="Center" TextChanged="VacancyTitleTextBox_TextChanged"/>
                    </StackPanel>

                    <StackPanel Orientation="Horizontal" Margin="0,0,20,0">
                        <Label Content="Город:" VerticalAlignment="Center" FontSize="21"/>
                        <ComboBox x:Name="CityComboBox" Width="150" Height="35" Margin="5,0" FontSize="21" VerticalContentAlignment="Center" SelectionChanged="CityComboBox_SelectionChanged">
                            <ComboBoxItem Content="Москва"/>
                            <ComboBoxItem Content="Санкт-Петербург"/>
                            <ComboBoxItem Content="Нижний Новгород"/>
                            <ComboBoxItem Content="Екатеринбург"/>
                            <ComboBoxItem Content="Казань"/>
                            <ComboBoxItem Content="Новосибирск"/>
                            <ComboBoxItem Content="Самара"/>
                            <ComboBoxItem Content="Ростов-на-Дону"/>
                            <ComboBoxItem Content="Краснодар"/>
                            <ComboBoxItem Content="Челябинск"/>
                            <ComboBoxItem Content="Абакан"/>
                            <ComboBoxItem Content="Анадырь"/>
                            <ComboBoxItem Content="Архангельск"/>
                            <ComboBoxItem Content="Астрахань"/>
                            <ComboBoxItem Content="Барнаул"/>
                            <ComboBoxItem Content="Белгород"/>
                            <ComboBoxItem Content="Биробиджан"/>
                            <ComboBoxItem Content="Брянск"/>
                            <ComboBoxItem Content="Великий Новгород"/>
                            <ComboBoxItem Content="Владивосток"/>
                            <ComboBoxItem Content="Владикавказ"/>
                            <ComboBoxItem Content="Владимир"/>
                            <ComboBoxItem Content="Волгоград"/>
                            <ComboBoxItem Content="Воронеж"/>
                            <ComboBoxItem Content="Грозный"/>
                            <ComboBoxItem Content="Иваново"/>
                            <ComboBoxItem Content="Ижевск"/>
                            <ComboBoxItem Content="Иркутск"/>
                            <ComboBoxItem Content="Йошкар-Ола"/>
                            <ComboBoxItem Content="Калининград"/>
                            <ComboBoxItem Content="Калуга"/>
                            <ComboBoxItem Content="Кемерово"/>
                            <ComboBoxItem Content="Киров"/>
                            <ComboBoxItem Content="Королев"/>
                            <ComboBoxItem Content="Кострома"/>
                            <ComboBoxItem Content="Краснодар"/>
                            <ComboBoxItem Content="Красноярск"/>
                            <ComboBoxItem Content="Курган"/>
                            <ComboBoxItem Content="Курск"/>
                            <ComboBoxItem Content="Кызыл"/>
                            <ComboBoxItem Content="Липецк"/>
                            <ComboBoxItem Content="Магадан"/>
                            <ComboBoxItem Content="Магнитогорск"/>
                            <ComboBoxItem Content="Махачкала"/>
                            <ComboBoxItem Content="Омск"/>
                            <ComboBoxItem Content="Пермь"/>
                            <ComboBoxItem Content="Ростов-на-Дону"/>
                        </ComboBox>
                    </StackPanel>

                    <!-- Верхняя панель -->
                    <Button x:Name="startButton" Style="{StaticResource StartButtonStyle}" 
        Content="Запуск парсера" Width="170" Height="35" Margin="5,0"
        Click="StartButton_Click"/>

                    <Button x:Name="stopButton" Style="{StaticResource StopButtonStyle}" 
        Content="Стоп" Width="120" Height="35" Margin="5,0"
        Click="StopButton_Click"/>

                    <Button x:Name="exportButton" Style="{StaticResource ExportButtonStyle}" 
        Content="Экспорт XLSX" Width="140" Height="35" Margin="5,0"
        Click="ExportButton_Click"/>

                    <!-- Остальные кнопки (без специального стиля) -->
                    <Button x:Name="loadBlacklistButton" Style="{StaticResource BaseButtonStyle}" 
        Content="Черный список" Width="150" Height="35" Margin="5,0"
        Click="LoadBlacklistButton_Click" Background="#FF9800" Foreground="White"/>
                </StackPanel>

                <!-- Вторая строка -->
                <StackPanel Grid.Row="1" Orientation="Horizontal" Margin="0,10,0,0">
                    <CheckBox x:Name="autoParseCheckBox" Content="Автопарсинг" Margin="5,0" VerticalAlignment="Center" FontSize="21"/>

                    <TextBox x:Name="parseTimeTextBox" Width="150" Height="35" Margin="5,0"
                    ToolTip="Формат: ЧЧ:ММ,ЧЧ:ММ" FontSize="21" VerticalContentAlignment="Center"/>

                    <CheckBox x:Name="OnlyWithPhonesCheckBox" Content="Только с телефонами" Margin="5,0" VerticalAlignment="Center" FontSize="21"/>

                    <StackPanel Orientation="Horizontal" Margin="10,0">
                        <CheckBox x:Name="vpnRotateAllCheckBox" Content="Ротация VPN" Margin="5,0" VerticalAlignment="Center" FontSize="21"/>
                        <CheckBox x:Name="vpnSelectCountryCheckBox" Content="Страна:" Margin="5,0" VerticalAlignment="Center" FontSize="21"/>
                        <ComboBox x:Name="vpnCountryComboBox" Width="120" Margin="5,0" FontSize="21" VerticalContentAlignment="Center">
                            <ComboBoxItem Content="США" Tag="US"/>
                            <ComboBoxItem Content="Канада" Tag="CN"/>
                            <ComboBoxItem Content="Япония" Tag="JP"/>
                            <ComboBoxItem Content="Нидерланды" Tag="NL"/>
                            <ComboBoxItem Content="Германия" Tag="GR"/>
                            <ComboBoxItem Content="Индонезия" Tag="ID"/>
                            <ComboBoxItem Content="Франция" Tag="FR"/>
                            <ComboBoxItem Content="Гонг Конг" Tag="HK"/>
                        </ComboBox>
                        <Button x:Name="testVpnButton" Content="Тест VPN" Width="100" Margin="5,0" FontSize="21" Click="TestVpnButton_Click"/>
                    </StackPanel>
                </StackPanel>
            </Grid>
        </Border>

        <!-- Панель фильтров и пагинации -->
        <ScrollViewer Grid.Row="1" HorizontalScrollBarVisibility="Auto" VerticalScrollBarVisibility="Disabled">
            <StackPanel Orientation="Horizontal" Margin="10">
                <Label Content="Дата от:" VerticalAlignment="Center" FontSize="21"/>
                <DatePicker x:Name="dateFromPicker" Width="120" Margin="5,0" SelectedDateChanged="DatePicker_SelectedDateChanged"/>
                <Label Content="Дата до:" VerticalAlignment="Center" FontSize="21"/>
                <DatePicker x:Name="dateToPicker" Width="120" Margin="5,0" SelectedDateChanged="DatePicker_SelectedDateChanged"/>
                <Label Content="Записей:" VerticalAlignment="Center"/>
                <Label x:Name="recordsCountLabel" Content="0" VerticalAlignment="Center"/>
                <Button Content="В начало" Width="80" Margin="5,0" Click="FirstPage_Click"/>
                <Button Content="Назад" Width="80" Margin="5,0" Click="PreviousPage_Click"/>
                <TextBox x:Name="currentPageTextBox" Width="40" Margin="5,0" Text="1" TextAlignment="Center" VerticalContentAlignment="Center" KeyDown="CurrentPageTextBox_KeyDown" PreviewTextInput="CurrentPageTextBox_PreviewTextInput" />
                <Label x:Name="totalPagesLabel" Content="из 1" VerticalAlignment="Center"/>
                <Button Content="Вперёд" Width="80" Margin="5,0" Click="NextPage_Click"/>
                <Button Content="В конец" Width="80" Margin="5,0" Click="LastPage_Click"/>
                <ComboBox x:Name="pageSizeComboBox" Width="60" Margin="5,0" SelectedIndex="1" VerticalContentAlignment="Center" SelectionChanged="PageSizeComboBox_SelectionChanged">
                    <ComboBoxItem Content="50"/>
                    <ComboBoxItem Content="100"/>
                    <ComboBoxItem Content="200"/>
                </ComboBox>
                <Label Content="Ожидание (сек):" VerticalAlignment="Center" Margin="10,0" FontSize="21"/>
                <TextBox x:Name="waitTimeTextBox" Width="40" Margin="5,0" FontSize="21" TextAlignment="Center" VerticalContentAlignment="Center" TextChanged="WaitTimeTextBox_TextChanged"/>
            </StackPanel>
        </ScrollViewer>

        <!-- Основная область -->
        <Grid Grid.Row="2">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="300"/>
            </Grid.ColumnDefinitions>

            <!-- Таблица -->
            <DataGrid x:Name="dataGrid" Grid.Column="0" Margin="10" AutoGenerateColumns="False" IsReadOnly="True"
          CanUserSortColumns="True" CanUserResizeColumns="True" CanUserReorderColumns="True"
          Background="White" BorderBrush="#CCCCCC" BorderThickness="1" Sorting="DataGrid_Sorting">
                <DataGrid.Resources>
                    <Style TargetType="DataGridColumnHeader">
                        <Setter Property="FontSize" Value="18"/>
                    </Style>
                </DataGrid.Resources>
                <DataGrid.Columns>
                    <DataGridTextColumn Header="№п/п" Binding="{Binding RowNumber}" Width="50">
                        <DataGridTextColumn.ElementStyle>
                            <Style TargetType="TextBlock">
                                <Setter Property="FontSize" Value="21"/>
                            </Style>
                        </DataGridTextColumn.ElementStyle>
                    </DataGridTextColumn>
                    <DataGridTextColumn Header="Дата парсинга" Binding="{Binding ParseDate, StringFormat=dd.MM.yyyy}" Width="100">
                        <DataGridTextColumn.ElementStyle>
                            <Style TargetType="TextBlock">
                                <Setter Property="FontSize" Value="21"/>
                            </Style>
                        </DataGridTextColumn.ElementStyle>
                    </DataGridTextColumn>
                    <DataGridTextColumn Header="Дата на сайте" Binding="{Binding Date, StringFormat=dd.MM.yyyy}" Width="100">
                        <DataGridTextColumn.ElementStyle>
                            <Style TargetType="TextBlock">
                                <Setter Property="FontSize" Value="21"/>
                            </Style>
                        </DataGridTextColumn.ElementStyle>
                    </DataGridTextColumn>
                    <DataGridTextColumn Header="ID на сайте" Binding="{Binding SiteId}" Width="80">
                        <DataGridTextColumn.ElementStyle>
                            <Style TargetType="TextBlock">
                                <Setter Property="FontSize" Value="18"/>
                            </Style>
                        </DataGridTextColumn.ElementStyle>
                    </DataGridTextColumn>
                    <DataGridTextColumn Header="Ссылка" Binding="{Binding Link}" Width="150">
                        <DataGridTextColumn.ElementStyle>
                            <Style TargetType="TextBlock">
                                <Setter Property="FontSize" Value="11"/>
                            </Style>
                        </DataGridTextColumn.ElementStyle>
                    </DataGridTextColumn>
                    <DataGridTextColumn Header="Название сайта" Binding="{Binding Domain}" Width="100">
                        <DataGridTextColumn.ElementStyle>
                            <Style TargetType="TextBlock">
                                <Setter Property="FontSize" Value="18"/>
                            </Style>
                        </DataGridTextColumn.ElementStyle>
                    </DataGridTextColumn>
                    <DataGridTextColumn Header="Телефон" Binding="{Binding Phone}" Width="100">
                        <DataGridTextColumn.ElementStyle>
                            <Style TargetType="TextBlock">
                                <Setter Property="FontSize" Value="18"/>
                            </Style>
                        </DataGridTextColumn.ElementStyle>
                    </DataGridTextColumn>
                    <DataGridTextColumn Header="Вакансия" Binding="{Binding Title}" Width="150">
                        <DataGridTextColumn.ElementStyle>
                            <Style TargetType="TextBlock">
                                <Setter Property="FontSize" Value="18"/>
                            </Style>
                        </DataGridTextColumn.ElementStyle>
                    </DataGridTextColumn>
                    <DataGridTextColumn Header="Адрес" Binding="{Binding Address}" Width="150">
                        <DataGridTextColumn.ElementStyle>
                            <Style TargetType="TextBlock">
                                <Setter Property="FontSize" Value="15"/>
                            </Style>
                        </DataGridTextColumn.ElementStyle>
                    </DataGridTextColumn>
                    <DataGridTextColumn Header="Компания" Binding="{Binding Company}" Width="150">
                        <DataGridTextColumn.ElementStyle>
                            <Style TargetType="TextBlock">
                                <Setter Property="FontSize" Value="15"/>
                            </Style>
                        </DataGridTextColumn.ElementStyle>
                    </DataGridTextColumn>
                    <DataGridTextColumn Header="ФИО" Binding="{Binding ContactName}" Width="100">
                        <DataGridTextColumn.ElementStyle>
                            <Style TargetType="TextBlock">
                                <Setter Property="FontSize" Value="15"/>
                            </Style>
                        </DataGridTextColumn.ElementStyle>
                    </DataGridTextColumn>
                </DataGrid.Columns>
            </DataGrid>

            <!-- Лог -->
            <GroupBox Grid.Column="1" Header="Лог" Margin="10" Background="White" BorderBrush="#CCCCCC">
                <TextBox x:Name="logTextBox" IsReadOnly="True" VerticalScrollBarVisibility="Visible" 
                         AcceptsReturn="True" TextWrapping="Wrap" BorderThickness="0"/>
            </GroupBox>
        </Grid>
    </Grid>
</Window>